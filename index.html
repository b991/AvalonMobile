<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Avalon Mobile</title>
    <link href="./src/output.css" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>

    <script>

//Stage 1:  Character Selection
        // Function to record the number entered by the user
        function recordNumber() {
            // Define an array to hold all good characters
            let goodCharacters = [
                "Loyal Servant of Arthur(Good1)",
                "Loyal Servant of Arthur(Good2)",
                "Loyal Servant of Arthur(Good3)",
                "Loyal Servant of Arthur(Good4)",
                "Loyal Servant of Arthur(Good5)"
            ];

            // Define an array to hold all evil characters
            let evilCharacters = [
                "Minion of Mordred(Evil1)",
                "Minion of Mordred(Evil2)",
                "Minion of Mordred(Evil3)"
            ];

            let assassin = "Assassin(Evil)-'Minion of Mordred'"
            let merlin = "Merlin(Good)-'Knows evil, must remain hidden'"
            let perc = "Percivel(Good)-'Knows Merlin'"
            let morgana = "Morgana(Evil)-'Appears as Merlin'"
            let mordred = "Unknown to Merlin"
            let oberon = "Unknown to Evil"

            
            function shuffleArray(arr) {
                for (let i = arr.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [arr[i], arr[j]] = [arr[j], arr[i]]; // Swap elements
                }
                return arr;
            }

            // Get the value from the input field
            let numInput = document.getElementById("num").value;

            // Convert input to a number
            let parsedNumber = parseInt(numInput);

//Stage 1.5: Create characters based on num of player
            // Game has common good (0), assasin, Merlin (2), Percival(3) and Morgana(4) built in. 
            if(parsedNumber==5){
                // 3 good, 2 evil
                const chooseGood = Math.floor(Math.random() * 5);
                let selectedGoodCharacter = goodCharacters[chooseGood]; // Access good1, good2, etc.
                let array = [selectedGoodCharacter,merlin,perc,assassin,morgana]
                shuffled = shuffleArray(array)
                sessionStorage.setItem('characterArray',  JSON.stringify(shuffled))
                sessionStorage.setItem('goodPeopleCount',3)
                sessionStorage.setItem('evilPeopleCount', 2)

            }
            if(parsedNumber == 6){
                // 4 good, 2 evil
                // has  Merlin, Percival, Loyal-knight * 2, Assassin, Morgana
                const chooseGood1 = Math.floor(Math.random() * 5);
                let sc1 = goodCharacters[chooseGood1]; // Access good1, good2, etc.

                const chooseGood2 = Math.floor(Math.random() * 5);
                let sc2 = goodCharacters[chooseGood2]; // Access good1, good2, etc.

                let array = [merlin, perc, sc1, sc2, assassin, morgana]
                shuffled = shuffleArray(array)
                sessionStorage.setItem('characterArray', JSON.stringify(shuffled))
                sessionStorage.setItem('goodPeopleCount', 4)
                sessionStorage.setItem('evilPeopleCount', 2)
            }
            if (parsedNumber == 7) {
                // 4 good, 3 evil
                // has  Merlin, Percival, Loyal-knight * 2, Mordred, Morgana, Assassin
                const chooseGood1 = Math.floor(Math.random() * 5);
                let sc1 = goodCharacters[chooseGood1]; // Access good1, good2, etc.

                const chooseGood2 = Math.floor(Math.random() * 5);
                let sc2 = goodCharacters[chooseGood2]; // Access good1, good2, etc.

                let array = [merlin, perc, sc1, sc2, mordred, morgana, assassin]
                shuffled = shuffleArray(array)
                sessionStorage.setItem('characterArray', JSON.stringify(shuffled))
                sessionStorage.setItem('goodPeopleCount', 4)
                sessionStorage.setItem('evilPeopleCount', 3)
            }
            if (parsedNumber == 8) {
                // 5 good, 3 evil
                // has  Merlin, Percival, Loyal-knight * 3, Mordred, Morgana, Assassin
                const chooseGood1 = Math.floor(Math.random() * 5);
                let sc1 = goodCharacters[chooseGood1]; // Access good1, good2, etc.

                const chooseGood2 = Math.floor(Math.random() * 5);
                let sc2 = goodCharacters[chooseGood2]; // Access good1, good2, etc.


                const chooseGood3 = Math.floor(Math.random() * 5);
                let sc3 = goodCharacters[chooseGood3]; // Access good1, good2, etc.


                let array = [merlin, perc, sc1, sc2, sc3, mordred, morgana, assassin]
                shuffled = shuffleArray(array)
                sessionStorage.setItem('characterArray', JSON.stringify(shuffled))
                sessionStorage.setItem('goodPeopleCount', 5)
                sessionStorage.setItem('evilPeopleCount', 3)
            }
            if (parsedNumber == 9) {
                // 6 good, 3 evil
                // has  Merlin, Percival, Loyal-knight * 4, Mordred, Morgana, Assassin
                const chooseGood1 = Math.floor(Math.random() * 5);
                let sc1 = goodCharacters[chooseGood1]; // Access good1, good2, etc.

                const chooseGood2 = Math.floor(Math.random() * 5);
                let sc2 = goodCharacters[chooseGood2]; // Access good1, good2, etc.


                const chooseGood3 = Math.floor(Math.random() * 5);
                let sc3 = goodCharacters[chooseGood3]; // Access good1, good2, etc.

                const chooseGood4 = Math.floor(Math.random() * 5);
                let sc4 = goodCharacters[chooseGood4]; // Access good1, good2, etc.


                let array = [merlin, perc, sc1, sc2, sc3, sc4, mordred, morgana, assassin]
                shuffled = shuffleArray(array)
                sessionStorage.setItem('characterArray', JSON.stringify(shuffled))
                sessionStorage.setItem('goodPeopleCount', 6)
                sessionStorage.setItem('evilPeopleCount', 3)
            }
            if (parsedNumber == 10) {
                // 6 good, 4 evil
                // has  Merlin, Percival, Loyal-knight * 4, Mordred, Morgana, Assassin, morderd-m
                const chooseGood1 = Math.floor(Math.random() * 5);
                let sc1 = goodCharacters[chooseGood1]; // Access good1, good2, etc.

                const chooseGood2 = Math.floor(Math.random() * 5);
                let sc2 = goodCharacters[chooseGood2]; // Access good1, good2, etc.


                const chooseGood3 = Math.floor(Math.random() * 5);
                let sc3 = goodCharacters[chooseGood3]; // Access good1, good2, etc.

                const chooseGood4 = Math.floor(Math.random() * 5);
                let sc4 = goodCharacters[chooseGood4]; // Access good1, good2, etc.

                const e1 = Math.floor(Math.random() * 3);
                let ec1 = evilCharacters[e1]; // Access good1, good2, etc.
                evilCharacters
                let array = [merlin, perc, sc1, sc2, sc3, sc4, mordred, morgana, assassin,ec1]
                shuffled = shuffleArray(array)
                sessionStorage.setItem('characterArray', JSON.stringify(shuffled))
                sessionStorage.setItem('goodPeopleCount', 6)
                sessionStorage.setItem('evilPeopleCount', 4)
            }
            // Store info 
            sessionStorage.setItem('playersNum', parsedNumber);

//Stage 2: Team Builiding. [x,y]: x is the number of quest, y is the num of players
            let firstQ = [2,2,2,3,3,3]
            let secondQ = [3, 3, 3, 4, 4, 4]
            let thirdQ = [2,4,3,4,4,4]
            let fourthQ = [3,3,4,5,5,5]
            let fifthQ = [3,4,4,5,5,5]
            questPlayerGrid = [firstQ, secondQ,thirdQ, fourthQ, fifthQ]
            sessionStorage.setItem('questPlayerGrid', JSON.stringify(questPlayerGrid))
            sessionStorage.setItem('questNum',1)
            let questResult = [-1,-1,-1,-1,-1]
            sessionStorage.setItem('questResult', JSON.stringify(questResult))


            // Get the message element
            let messageElement = document.getElementById("warning_message");

            // Check if the input is valid (between 5 and 10)
            if (!isNaN(parsedNumber) && parsedNumber >= 5 && parsedNumber <= 10) {
                window.location.href = "./src/stage_1_pickCards.html";
            } else {
                // Show warning message
                messageElement.innerText = "Please enter a valid number between 5 and 10.";
            }
        }
    </script>
</head>
<body>
    <div class="absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80" aria-hidden="true">
        <div class="relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-30 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]"
            style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)">
        </div>
    </div>
    <!-- Acutal Content Begins -->

    <!-- Navbar -->
    <nav class="bg-indigo-600">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="md:flex space-x-4">
                    <a href="index.html" class="text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-500">Home</a>
                    <a href="./src/stage_1_pickCards.html" class="text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-500">Select-Characters</a>
                    <a href="./src/stage_2_teamBuilding.html" class="text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-500">Team-Building</a>
                    <a href="./src/stage_3_quest.html" class="text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-500">Quest</a>
                    <a href="./src/info.html" class="text-white px-3 py-2 rounded-md text-sm font-medium hover:bg-indigo-500">Info</a>

                </div>

            </div>
        </div>

    </nav>
    <!-- Main Section -->
    <div class="flex mt-32 flex-grow flex-col items-center justify-center">
        <div class="p-4">
            <div class="text-center rounded-md bg-indigo-50 px-2.5 py-2.5 text-xl font-bold text-indigo-600 shadow-sm hover:bg-indigo-100">Welcome to Avalon Mobile</div>
            <label for="num" class="pt-4 block text-sm font-medium leading-6 text-gray-900">Enter how many people are playing the game:</label>
            <div class="mt-2">
                <input type="number" name="num" id="num"
                    class="p-2 text-gray-900 rounded-md border-2"
                    placeholder="5">
            </div>
            <p class="mt-2 text-sm pb-2 text-gray-500" id="email-description">Enter a number between 5 and 10</p>
            <button type="button"
                class="flex justify-center rounded bg-indigo-600 px-2 py-1 text-md font-semibold text-white shadow-sm hover:bg-indigo-500  focus-visible:outline-offset-2 focus-visible:outline-indigo-600"
                onclick="recordNumber()">Enter</button>
            <div id="warning_message" class="mt-2 text-sm text-rose-600"></div>
        </div>    
    <div class="px-16 text-xl text-gray-700 text-center font-bold">Good vs Evil Count</div>
    <div class="flex justify-center mt-4">
        <img src="./src/images/GoodEvilCount.png" class="h-24 object-contain rounded-lg shadow-lg">
    </div>
    <div class="m-16 text-md text-gray-700 space-y-4">
        5 player set-up: <span class="text-green-600">Merlin, Percival, Loyal-knight,</span> <span class="text-red-600">Assassin, Morgana</span><br>
        6 player* set-up: <span class="text-green-600">Merlin, Percival, Loyal-knight * 2,</span> <span class="text-red-600">Assassin, Morgana</span><br>
        7 player* set-up: <span class="text-green-600">Merlin, Percival, Loyal-knight * 2,</span> <span class="text-red-600">Mordred, Morgana, Assassin</span><br>
        8 player* set-up: <span class="text-green-600">Merlin, Percival, Loyal-knight * 3,</span> <span class="text-red-600">Mordred, Morgana, Assassin</span><br>
        9 player* set-up: <span class="text-green-600">Merlin, Percival, Loyal-knight * 4,</span> <span class="text-red-600">Mordred, Morgana, Assassin</span><br>
        10 player* set-up: <span class="text-green-600">Merlin, Percival, Loyal-knight * 4,</span> <span class="text-red-600">Mordred, Morgana, Assassin, Mordred-minion</span><br>

    </div>
    </div>

    <div class="text-sm font-bold py-4 mt-16 text-center text-indigo-600 bg-indigo-50 ">&copy b991, 2024</div>
    <!-- Acutal Content Ends -->
    <div class="absolute inset-x-0 -top-40 -z-10 transform-gpu overflow-hidden blur-3xl sm:-top-80" aria-hidden="true">
        <div class="relative left-[calc(50%-11rem)] aspect-[1155/678] w-[36.125rem] -translate-x-1/2 rotate-[30deg] bg-gradient-to-tr from-[#ff80b5] to-[#9089fc] opacity-30 sm:left-[calc(50%-30rem)] sm:w-[72.1875rem]"
            style="clip-path: polygon(74.1% 44.1%, 100% 61.6%, 97.5% 26.9%, 85.5% 0.1%, 80.7% 2%, 72.5% 32.5%, 60.2% 62.4%, 52.4% 68.1%, 47.5% 58.3%, 45.2% 34.5%, 27.5% 76.7%, 0.1% 64.9%, 17.9% 100%, 27.6% 76.8%, 76.1% 97.7%, 74.1% 44.1%)">
        </div>
    </div>


</body>
</html>
